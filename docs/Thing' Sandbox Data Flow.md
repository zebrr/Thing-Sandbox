# Ğ¡Ñ…ĞµĞ¼Ğ° Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ¾Ğ² Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Thing' Sandbox

## ĞĞ±Ğ·Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

**Character** (Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶):
```
identity: {id, name, description, triggers}            â† ÑÑ‚Ğ°Ñ‚Ğ¸ĞºĞ°
state:    {location, internal_state, external_intent}  â† Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸ĞºĞ°
memory:   {cells[{tick, text}], summary}               â† ÑÑƒĞ±ÑŠĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ°Ñ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ
```

**Location** (Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ñ):
```
identity: {id, name, description, connections[{location_id, description}]}  â† ÑÑ‚Ğ°Ñ‚Ğ¸ĞºĞ°
state:    {moment}                                                          â† Ğ´Ğ¸Ğ½Ğ°Ğ¼Ğ¸ĞºĞ° (Ñ‡Ñ‚Ğ¾ Ğ¿Ñ€ÑĞ¼Ğ¾ ÑĞµĞ¹Ñ‡Ğ°Ñ)
```

---

## Ğ¡Ñ…ĞµĞ¼Ğ° Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞ° Ğ¿Ğ¾ Ñ„Ğ°Ğ·Ğ°Ğ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              PHASE 1: INTENTION (N Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²)                    â”‚
â”‚                                                                                 â”‚
â”‚  SYSTEM PROMPT                     USER PROMPT                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ Setting (limited)    â”‚        â”‚ CHARACTER                               â”‚  â”‚
â”‚  â”‚   [Ğ¼Ğ¸Ñ€ Ğ³Ğ»Ğ°Ğ·Ğ°Ğ¼Ğ¸ char]   â”‚        â”‚ â€¢ identity.name                         â”‚  â”‚
â”‚  â”‚ â€¢ Role                 â”‚        â”‚ â€¢ identity.description                  â”‚  â”‚
â”‚  â”‚ â€¢ Constraints          â”‚        â”‚ â€¢ identity.triggers                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ STATE                                   â”‚  â”‚
â”‚                                    â”‚ â€¢ state.internal_state                  â”‚  â”‚
â”‚                                    â”‚ â€¢ state.external_intent                 â”‚  â”‚
â”‚                                    â”‚ MEMORY                                  â”‚  â”‚
â”‚                                    â”‚ â€¢ memory.cells[].text (newest first)    â”‚  â”‚
â”‚                                    â”‚ â€¢ memory.summary                        â”‚  â”‚
â”‚                                    â”‚ LOCATION (where char is)                â”‚  â”‚
â”‚                                    â”‚ â€¢ location.identity.name, description   â”‚  â”‚
â”‚                                    â”‚ â€¢ location.state.moment                 â”‚  â”‚
â”‚                                    â”‚ â€¢ location.identity.connections[]       â”‚  â”‚
â”‚                                    â”‚ OTHERS (same location, identity only)   â”‚  â”‚
â”‚                                    â”‚ â€¢ other.identity.name, description      â”‚  â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                 â”‚
â”‚                           OUTPUT: IntentionResponse {intention}                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             PHASE 2a: RESOLUTION (L Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²)                   â”‚
â”‚                                                                                 â”‚
â”‚  SYSTEM PROMPT                     USER PROMPT                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ Setting (FULL!)      â”‚        â”‚ LOCATION                                â”‚  â”‚
â”‚  â”‚   [Ğ¿Ñ€Ğ°Ğ²Ğ´Ğ° Ğ¾ Ğ¼Ğ¸Ñ€Ğµ,      â”‚        â”‚ â€¢ location.identity.* (id, name, desc)  â”‚  â”‚
â”‚  â”‚    ÑĞºÑ€Ñ‹Ñ‚Ñ‹Ğµ Ğ¼ĞµÑ…Ğ°Ğ½Ğ¸ĞºĞ¸]   â”‚        â”‚ â€¢ location.state.moment                 â”‚  â”‚
â”‚  â”‚ â€¢ Role (Game Master)   â”‚        â”‚ â€¢ location.identity.connections[]       â”‚  â”‚
â”‚  â”‚ â€¢ Rules                â”‚        â”‚ â€¢ [valid location IDs list]             â”‚  â”‚
â”‚  â”‚ â€¢ Constraints          â”‚        â”‚ CHARACTERS (in this location)           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â€¢ char.identity.* (id, name, desc, trig)â”‚  â”‚
â”‚                                    â”‚ â€¢ char.state.internal_state             â”‚  â”‚
â”‚                                    â”‚ â€¢ char.state.external_intent            â”‚  â”‚
â”‚                                    â”‚ â€¢ **ĞĞ•Ğ¢** memory!                       â”‚  â”‚
â”‚                                    â”‚ INTENTIONS                              â”‚  â”‚
â”‚                                    â”‚ â€¢ {char_id: intention} dict             â”‚  â”‚
â”‚                                    â”‚ TICK                                    â”‚  â”‚
â”‚                                    â”‚ â€¢ simulation.current_tick               â”‚  â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                 â”‚
â”‚                 OUTPUT: MasterOutput                                            â”‚
â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚                 â”‚ tick, location_id                             â”‚               â”‚
â”‚                 â”‚ characters: {                                 â”‚               â”‚
â”‚                 â”‚   char_id: {                                  â”‚               â”‚
â”‚                 â”‚     location,          â† Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒÑÑ     â”‚               â”‚
â”‚                 â”‚     internal_state,    â† Ğ½Ğ¾Ğ²Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ      â”‚               â”‚
â”‚                 â”‚     external_intent,   â† Ğ½Ğ¾Ğ²Ñ‹Ğµ Ñ†ĞµĞ»Ğ¸           â”‚               â”‚
â”‚                 â”‚     memory_entry       â† ĞĞĞ’ĞĞ¯ Ğ—ĞĞŸĞ˜Ğ¡Ğ¬ ĞŸĞĞœĞ¯Ğ¢Ğ˜  â”‚               â”‚
â”‚                 â”‚   }                                           â”‚               â”‚
â”‚                 â”‚ }                                             â”‚               â”‚
â”‚                 â”‚ location: {                                   â”‚               â”‚
â”‚                 â”‚   moment,               â† Ñ‡Ñ‚Ğ¾ ÑĞµĞ¹Ñ‡Ğ°Ñ          â”‚               â”‚
â”‚                 â”‚   description (null if unchanged)             â”‚               â”‚
â”‚                 â”‚ }                                             â”‚               â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             PHASE 2b: NARRATIVE (L Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²)                    â”‚
â”‚                                                                                 â”‚
â”‚  SYSTEM PROMPT                   USER PROMPT                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ Setting (Ğ°Ñ‚Ğ¼Ğ¾ÑÑ„ĞµÑ€Ğ°,  â”‚      â”‚ LOCATION                                  â”‚  â”‚
â”‚  â”‚   ÑÑ‚Ğ¸Ğ»ÑŒ, Ğ¶Ğ°Ğ½Ñ€)         â”‚      â”‚ â€¢ location_before.identity.name, desc     â”‚  â”‚
â”‚  â”‚ â€¢ Context              â”‚      â”‚ â€¢ location_before.state.moment            â”‚  â”‚
â”‚  â”‚ â€¢ Role (Narrator)      â”‚      â”‚ â€¢ master_result.location.moment (after)   â”‚  â”‚
â”‚  â”‚ â€¢ Style                â”‚      â”‚ â€¢ master_result.location.description      â”‚  â”‚
â”‚  â”‚ â€¢ Constraints          â”‚      â”‚ CHARACTERS (for each)                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ â€¢ char_before.identity.* (name,desc,trig) â”‚  â”‚
â”‚                                  â”‚ â€¢ char_before.state.* (internal,external) â”‚  â”‚
â”‚                                  â”‚ â€¢ intentions[char_id] (Ñ‡Ñ‚Ğ¾ Ñ…Ğ¾Ñ‚ĞµĞ»)         â”‚  â”‚
â”‚                                  â”‚ â€¢ master_result.characters[char_id].*     â”‚  â”‚
â”‚                                  â”‚   (internal_state, external_intent AFTER) â”‚  â”‚
â”‚                                  â”‚ â€¢ movement info (if location changed)     â”‚  â”‚
â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                 â”‚
â”‚                       OUTPUT: NarrativeResponse {narrative}                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PHASE 3: APPLICATION (0 LLM Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²)                    â”‚
â”‚                                                                                 â”‚
â”‚  ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ÑĞµĞ¼ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ Ğ¸Ğ· MasterOutput:                                           â”‚
â”‚                                                                                 â”‚
â”‚  Character.state.location        â† master.characters[id].location               â”‚
â”‚  Character.state.internal_state  â† master.characters[id].internal_state         â”‚
â”‚  Character.state.external_intent â† master.characters[id].external_intent        â”‚
â”‚  Character.memory.cells          â† PREPEND {tick, memory_entry} to cells[0]     â”‚
â”‚                                                                                 â”‚
â”‚  Location.state.moment           â† master.location.moment                       â”‚
â”‚  Location.identity.description   â† master.location.description (if not null)    â”‚
â”‚                                                                                 â”‚
â”‚  memory.cells ÑĞ´Ğ²Ğ¸Ğ³Ğ°ĞµÑ‚ÑÑ, oldest cell Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ÑÑ Ğº Ğ²Ñ‹Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ñ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             PHASE 4: SUMMARY (N Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²)                       â”‚
â”‚                           (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ cells overflow)                          â”‚
â”‚                                                                                 â”‚
â”‚  SYSTEM PROMPT                     USER PROMPT                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ Setting (limited)    â”‚        â”‚ CHARACTER                               â”‚  â”‚
â”‚  â”‚   [ĞºĞ°Ğº Ğ² Phase 1]      â”‚        â”‚ â€¢ identity.name                         â”‚  â”‚
â”‚  â”‚ â€¢ Role (compressor)    â”‚        â”‚ â€¢ identity.description                  â”‚  â”‚
â”‚  â”‚ â€¢ Priorities           â”‚        â”‚ OLD SUMMARY                             â”‚  â”‚
â”‚  â”‚ â€¢ Constraints          â”‚        â”‚ â€¢ memory.summary                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ DROPPING MEMORY                         â”‚  â”‚
â”‚                                    â”‚ â€¢ memory.cells[-1].text (oldest cell)   â”‚  â”‚
â”‚                                    â”‚ TICK                                    â”‚  â”‚
â”‚                                    â”‚ â€¢ simulation.current_tick               â”‚  â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                                 â”‚
â”‚                        OUTPUT: SummaryResponse {summary}                        â”‚
â”‚                                                                                 â”‚
â”‚  ĞŸĞ¾ÑĞ»Ğµ: Character.memory.summary â† new summary                                  â”‚
â”‚         Character.memory.cells   â† remove oldest cell                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ĞœĞ°Ñ‚Ñ€Ğ¸Ñ†Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

| ĞŸĞ¾Ğ»Ğµ | Ph1 | Ph2a | Ph2b | Ph3 | Ph4 | ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ |
|------|-----|------|------|-----|-----|------------|
| **CHARACTER** |
| identity.id | â€” | âœ“ | â€” | âœ“ | â€” | key Ğ² intentions, master |
| identity.name | âœ“ | âœ“ | âœ“ | â€” | âœ“ | Ğ²ĞµĞ·Ğ´Ğµ Ğ³Ğ´Ğµ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ |
| identity.description | âœ“ | âœ“ | âœ“ | â€” | âœ“ | Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€ |
| identity.triggers | âœ“ | âœ“ | âœ“ | â€” | â€” | Ñ€ĞµĞ°ĞºÑ†Ğ¸Ğ¸ |
| state.location | âœ“* | âœ“* | âœ“ | **W** | â€” | *Ğ²Ñ‹Ğ±Ğ¾Ñ€ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ĞµĞ¹ |
| state.internal_state | âœ“ | âœ“ | âœ“â†’âœ“ | **W** | â€” | beforeâ†’after Ğ² 2b |
| state.external_intent | âœ“ | âœ“ | âœ“â†’âœ“ | **W** | â€” | beforeâ†’after Ğ² 2b |
| memory.cells[].text | âœ“ | â€” | â€” | **W** | âœ“ | oldest Ğ² ph4 |
| memory.cells[].tick | â€” | â€” | â€” | **W** | â€” | Ñ‚ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ |
| memory.summary | âœ“ | â€” | â€” | **W** | âœ“ | ÑĞ¶Ğ°Ñ‚Ğ°Ñ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ |
| **LOCATION** |
| identity.id | â€” | âœ“ | â€” | âœ“ | â€” | ĞºĞ»ÑÑ‡ Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ğ¸ |
| identity.name | âœ“ | âœ“ | âœ“ | â€” | â€” | |
| identity.description | âœ“ | âœ“ | âœ“ | **W** | â€” | Ñ€ĞµĞ´ĞºĞ¾ Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ |
| identity.connections | âœ“ | âœ“ | âœ“ | â€” | â€” | ĞºÑƒĞ´Ğ° Ğ¸Ğ´Ñ‚Ğ¸ |
| state.moment | âœ“ | âœ“ | âœ“â†’âœ“ | **W** | â€” | beforeâ†’after Ğ² 2b |
| **OTHER** |
| intentions{} | â€” | âœ“ | âœ“ | â€” | â€” | Phase 1 output |
| master_result | â€” | â€” | âœ“ | âœ“ | â€” | Phase 2a output |
| narrative | â€” | â€” | â€” | â€” | â€” | Phase 2b output (Ğ»Ğ¾Ğ³) |
| simulation.current_tick | â€” | âœ“ | â€” | â€” | âœ“ | Ğ² user prompt |

**Ğ›ĞµĞ³ĞµĞ½Ğ´Ğ°:** âœ“ = Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ, **W** = Ğ·Ğ°Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ, âœ“â†’âœ“ = beforeâ†’after, * = Ğ½ĞµÑĞ²Ğ½Ğ¾ (Ğ´Ğ»Ñ ÑĞ±Ğ¾Ñ€ĞºĞ¸)

---

### ĞĞ½Ğ°Ğ»Ğ¸Ğ·: Ñ‡Ñ‚Ğ¾ Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾ âœ…

1. **Ğ§Ñ‘Ñ‚ĞºĞ¾Ğµ Ñ€Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ½Ğ°Ğ½Ğ¸Ñ:**
   - Phase 1/4 â€” Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ ĞĞ• Ğ·Ğ½Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ°Ğ²Ğ´Ñƒ Ğ¾ Ğ¼Ğ¸Ñ€Ğµ (Setting limited)
   - Phase 2a â€” Ğ°Ñ€Ğ±Ğ¸Ñ‚Ñ€ Ğ·Ğ½Ğ°ĞµÑ‚ Ğ’Ğ¡Ğ (Setting full)
   - Phase 2b â€” Ğ½Ğ°Ñ€Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ·Ğ½Ğ°ĞµÑ‚ Ğ²ÑÑ‘, Ğ½Ğ¾ Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ñ‡Ñ‚Ğ¾ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°Ñ‚ÑŒ

2. **ĞŸĞ°Ğ¼ÑÑ‚ÑŒ Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°:** Ğ°Ñ€Ğ±Ğ¸Ñ‚Ñ€ (2a) Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ĞµĞ¹ â€” Ñ€ĞµÑˆĞ°ĞµÑ‚ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ identity + state + intention. Ğ­Ñ‚Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾: Ğ¾Ğ½ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ, Ğ° Ğ½Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸.

3. **Others â€” Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ identity:** Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ğ²Ğ½ÑƒÑ‚Ñ€ĞµĞ½Ğ½Ğ¸Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… â€” Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ name + description. ĞšĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ°Ñ Ğ¸Ğ·Ğ¾Ğ»ÑÑ†Ğ¸Ñ.

4. **Triggers Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´ÑÑ‚ Ğ²ĞµĞ·Ğ´Ğµ Ğ³Ğ´Ğµ Ğ½ÑƒĞ¶Ğ½Ñ‹:** 
   - Phase 1 â€” Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ Ğ·Ğ½Ğ°ĞµÑ‚ ÑĞ²Ğ¾Ğ¸ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹
   - Phase 2a â€” Ğ°Ñ€Ğ±Ğ¸Ñ‚Ñ€ ÑƒÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ¿Ñ€Ğ¸ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¸
   - Phase 2b â€” Ğ½Ğ°Ñ€Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ´Ğ»Ñ Ğ»ÑƒÑ‡ÑˆĞµĞ³Ğ¾ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ

5. **Valid location IDs** Ğ² Phase 2a â€” Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ³Ğ°Ğ»Ğ»ÑÑ†Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¹ Ğ°Ñ€Ğ±Ğ¸Ñ‚Ñ€Ğ° Ñ Ğ½ĞµÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¼Ğ¸ Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸ÑĞ¼Ğ¸.

---

### ĞĞ½Ğ°Ğ»Ğ¸Ğ·: Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ âš ï¸

**1. Phase 2b Ğ½Ğµ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ tick ÑĞ²Ğ½Ğ¾**
Phase 2a Ğ¸ Phase 4 Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ÑÑ‚ `simulation.current_tick`, Ğ° Phase 2b â€” Ğ½ĞµÑ‚. Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ½Ğµ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ğ¾ (Ğ½Ğ°Ñ€Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ½Ğµ Ğ½ÑƒĞ¼ĞµÑ€ÑƒĞµÑ‚ Ñ‚Ğ¸ĞºĞ¸), Ğ½Ğ¾ Ğ´Ğ»Ñ ĞºĞ¾Ğ½ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ.

**2. Location.identity.description â€” Ñ€ĞµĞ´ĞºĞ¾ Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ**
MasterOutput Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ `location.description`, Ğ½Ğ¾:
- Ğ’ Phase 2a system prompt Ğ½ĞµÑ‚ ÑĞ²Ğ½Ğ¾Ğ³Ğ¾ ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ¸Ñ ĞºĞ¾Ğ³Ğ´Ğ° ÑÑ‚Ğ¾ Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ
- Ğ­Ñ‚Ğ¾ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ñ€ĞµĞ´ĞºĞ¾Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ (Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¾ Ğ¼ĞµÑÑ‚Ğ¾)

**3. Others Ğ² Phase 1 â€” Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ identity**
Ğ­Ñ‚Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¾Ğ»ÑÑ†Ğ¸Ğ¸, ĞĞ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ¸Ñ‚:
- Ğ§Ñ‚Ğ¾ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ğ¿Ñ€ÑĞ¼Ğ¾ ÑĞµĞ¹Ñ‡Ğ°Ñ (ÑÑ‚Ğ¾ Ğ¾Ğº â€” Ğ¾Ğ½ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ñ‡ĞµÑ€ĞµĞ· `moment`)
- Ğ­Ğ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… (ÑÑ‚Ğ¾ Ğ¾Ğº â€” Ğ½Ğµ Ñ‚ĞµĞ»ĞµĞ¿Ğ°Ñ‚)

ĞĞ¾ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ ĞœĞĞ–Ğ•Ğ¢ Ñ…Ğ¾Ñ‚ĞµÑ‚ÑŒ Ğ²Ğ¸Ğ´ĞµÑ‚ÑŒ "Ñ‡Ñ‚Ğ¾ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ´ĞµĞ»Ğ°ĞµÑ‚" ĞºĞ°Ğº Ñ‡Ğ°ÑÑ‚ÑŒ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ? Ğ¡ĞµĞ¹Ñ‡Ğ°Ñ ÑÑ‚Ğ¾ Ñ‡ĞµÑ€ĞµĞ· `moment` Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ğ¸, Ğ½Ğ¾ Ğ½Ğµ Ğ²ÑĞµĞ³Ğ´Ğ° Ğ¾Ñ‡ĞµĞ²Ğ¸Ğ´Ğ½Ğ¾.

---

### ĞĞ½Ğ°Ğ»Ğ¸Ğ·: Ğ¸Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ğŸ”

**1. identity.triggers Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ**
ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ÑÑ Ğ² Phase 1, 2a, 2b â€” Ñ‚Ñ€Ğ¸ Ñ€Ğ°Ğ·Ğ°. Ğ­Ñ‚Ğ¾ Ğ¾Ğº, Ñ‚Ğ°Ğº ĞºĞ°Ğº:
- Phase 1 â€” Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ Ğ·Ğ½Ğ°ĞµÑ‚ ÑĞ²Ğ¾Ğ¸ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹
- Phase 2a â€” Ğ°Ñ€Ğ±Ğ¸Ñ‚Ñ€ ÑƒÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¸ Ñ€Ğ°Ğ·Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¸
- Phase 2b â€” Ğ½Ğ°Ñ€Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ

ĞĞµ Ğ¸Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ â€” Ñ€Ğ°Ğ·Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ.

**2. Location connections**
ĞŸĞµÑ€ĞµĞ´Ğ°ÑÑ‚ÑÑ Ğ² Phase 1, 2a, 2b. ĞÑƒĞ¶Ğ½Ñ‹ Ğ²ĞµĞ·Ğ´Ğµ:
- Phase 1 â€” Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ ĞºÑƒĞ´Ğ° Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ğ¾Ğ¹Ñ‚Ğ¸
- Phase 2a â€” Ğ°Ñ€Ğ±Ğ¸Ñ‚Ñ€ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ
- Phase 2b â€” Ğ½Ğ°Ñ€Ñ€Ğ°Ñ‚Ğ¾Ñ€ Ğ¾Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ ÑƒÑ…Ğ¾Ğ´ Ğ¿ĞµÑ€ÑĞ¾Ğ½Ğ°Ğ¶Ğ°

**Ğ’Ñ‹Ğ²Ğ¾Ğ´:** ÑĞ²Ğ½Ğ¾Ğ¹ Ğ¸Ğ·Ğ±Ñ‹Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸ (Ğ¼Ñ‘Ñ€Ñ‚Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ»ĞµĞ¹) Ğ½Ğµ Ğ½Ğ°ÑˆÑ‘Ğ». Ğ’ÑĞµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ÑÑ.
